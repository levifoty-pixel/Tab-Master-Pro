<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Tab Master Pro - Studio</title>
  <style>
    /* GLOBAL */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: radial-gradient(circle at top, #ff4b2b 0, #111 45%, #050509 100%);
      color: #f5f5f5;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* LAYOUT */

    .sidebar {
      width: 220px;
      background: rgba(10, 10, 20, 0.96);
      border-right: 1px solid rgba(255, 255, 255, 0.06);
      display: flex;
      flex-direction: column;
      padding: 16px 12px;
      backdrop-filter: blur(10px);
    }

    .logo {
      font-weight: 800;
      font-size: 1.1rem;
      letter-spacing: 0.06em;
      margin-bottom: 16px;
      padding: 8px 10px;
      border-radius: 10px;
      background: linear-gradient(135deg, #ff512f, #dd2476);
      text-align: center;
    }

    .nav-title {
      font-size: 0.8rem;
      text-transform: uppercase;
      opacity: 0.6;
      margin: 8px 8px 4px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      padding: 8px 10px;
      border-radius: 8px;
      cursor: pointer;
      margin: 2px 4px;
      font-size: 0.95rem;
      transition: background 0.18s ease, transform 0.12s ease;
      gap: 8px;
    }

    .nav-item span.icon {
      width: 18px;
      text-align: center;
      opacity: 0.8;
    }

    .nav-item.active {
      background: linear-gradient(135deg, #ff512f55, #dd247655);
      transform: translateY(-1px);
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.6);
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.06);
    }

    .nav-separator {
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      margin: 10px 4px;
    }

    .sidebar-bottom {
      margin-top: auto;
      font-size: 0.8rem;
      opacity: 0.7;
      padding: 6px 8px;
    }

    .main {
      flex: 1;
      padding: 18px 22px;
      overflow-y: auto;
      background: radial-gradient(circle at top left, #ff512f11 0, transparent 40%),
                  radial-gradient(circle at bottom right, #dd247611 0, transparent 40%);
    }

    .main-inner {
      max-width: 1100px;
      margin: 0 auto;
    }

    /* PANELS */

    .hero {
      background: linear-gradient(135deg, rgba(255, 81, 47, 0.7), rgba(221, 36, 118, 0.7));
      border-radius: 16px;
      padding: 18px 20px;
      margin-bottom: 18px;
      display: flex;
      justify-content: space-between;
      gap: 18px;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
    }

    .hero-left h1 {
      margin: 0 0 6px;
      font-size: 1.7rem;
    }

    .hero-left p {
      margin: 0;
      opacity: 0.9;
      font-size: 0.95rem;
    }

    .hero-tags {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .tag {
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      background: rgba(0, 0, 0, 0.12);
    }

    .hero-cta {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 8px;
      min-width: 190px;
    }

    .hero-cta button {
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: transform 0.12s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    .hero-cta button.primary {
      background: #0b0b10;
      color: #fff;
      box-shadow: 0 0 16px rgba(0, 0, 0, 0.7);
    }

    .hero-cta button.secondary {
      background: rgba(0, 0, 0, 0.16);
      color: #f5f5f5;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .hero-cta button:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 18px rgba(0, 0, 0, 0.8);
    }

    /* STUDIO PANELS */

    .panel-grid {
      display: grid;
      grid-template-columns: 3fr 2fr;
      gap: 16px;
      margin-bottom: 18px;
    }

    .panel {
      background: radial-gradient(circle at top, #222 0, #15151b 55%, #101017 100%);
      border-radius: 14px;
      padding: 14px 16px 16px;
      border: 1px solid rgba(255, 255, 255, 0.06);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(10px);
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .panel-header h2 {
      margin: 0;
      font-size: 1rem;
    }

    .pill {
      font-size: 0.7rem;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(255, 81, 47, 0.15);
      border: 1px solid rgba(255, 81, 47, 0.5);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .panel-body {
      font-size: 0.88rem;
      opacity: 0.9;
    }

    .hidden {
      display: none !important;
    }

    /* SONG GENERATOR */

    .field-label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      opacity: 0.75;
      margin: 8px 0 4px;
    }

    textarea {
      width: 100%;
      min-height: 80px;
      resize: vertical;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(5, 5, 10, 0.9);
      color: #f5f5f5;
      padding: 8px 10px;
      font-family: inherit;
      font-size: 0.9rem;
      outline: none;
    }

    textarea:focus {
      border-color: #ff512f;
      box-shadow: 0 0 0 1px rgba(255, 81, 47, 0.4);
    }

    select, input[type="text"], input[type="url"] {
      width: 100%;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(5, 5, 10, 0.9);
      color: #f5f5f5;
      padding: 6px 10px;
      font-size: 0.9rem;
      outline: none;
    }

    select:focus, input:focus {
      border-color: #ff512f;
      box-shadow: 0 0 0 1px rgba(255, 81, 47, 0.4);
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
      background: linear-gradient(135deg, #ff512f, #dd2476);
      color: #fff;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.7);
      transition: transform 0.12s ease, box-shadow 0.15s ease, filter 0.15s ease;
    }

    .btn:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.8);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: none;
    }

    .btn-secondary:hover {
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.7);
    }

    .progress-bar {
      width: 100%;
      background-color: #282832;
      border-radius: 999px;
      margin-top: 8px;
      height: 12px;
      overflow: hidden;
      display: none;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #ff512f, #ffb347);
      transition: width 0.12s linear;
      box-shadow: 0 0 10px rgba(255, 81, 47, 0.7);
    }

    .tiny {
      font-size: 0.78rem;
      opacity: 0.75;
      margin-top: 4px;
    }

    .song-output {
      margin-top: 10px;
      padding: 10px;
      border-radius: 10px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 255, 255, 0.12);
      max-height: 170px;
      overflow-y: auto;
      font-size: 0.87rem;
      line-height: 1.4;
    }

    /* STEM SEPARATOR PANEL */

    .row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .file-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 10px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.16);
      font-size: 0.8rem;
      margin-top: 6px;
    }

    .file-input-hidden {
      display: none;
    }

    /* TABS STUDIO */

    .tabs-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 8px;
    }

    .tabs-box {
      background: rgba(0, 0, 0, 0.4);
      border-radius: 10px;
      padding: 8px 10px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      font-family: monospace;
      font-size: 0.85rem;
      min-height: 120px;
      white-space: pre;
      overflow-x: auto;
    }

    .tabs-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
      font-size: 0.82rem;
    }

    /* HORIZONTAL DAW */

    .daw-shell {
      margin-top: 8px;
      background: radial-gradient(circle at top left, #2b2b36 0, #11121a 60%, #050509 100%);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 12px;
      box-shadow: inset 0 0 18px rgba(0, 0, 0, 0.8);
    }

    .daw-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.84rem;
      margin-bottom: 6px;
    }

    .daw-header-left span {
      margin-right: 10px;
      opacity: 0.86;
    }

    .daw-timeline {
      position: relative;
      border-radius: 8px;
      background: #15151f;
      padding: 4px 6px 8px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .daw-ruler {
      display: flex;
      font-size: 0.75rem;
      color: #aaa;
      margin-bottom: 4px;
    }

    .daw-ruler div {
      width: 70px;
      text-align: center;
    }

    .daw-track-row {
      display: flex;
      align-items: center;
      margin: 3px 0;
    }

    .daw-track-label {
      width: 80px;
      font-size: 0.8rem;
      opacity: 0.85;
    }

    .daw-track-lane {
      flex: 1;
      height: 28px;
      position: relative;
      background-image: linear-gradient(
        to right,
        rgba(255, 255, 255, 0.06) 1px,
        transparent 1px
      );
      background-size: 70px 100%;
      border-radius: 6px;
      overflow: hidden;
    }

    .daw-clip {
      position: absolute;
      left: 6px;
      top: 4px;
      height: 20px;
      width: 170px;
      border-radius: 4px;
      background: linear-gradient(135deg, #ff512f, #ffb347);
      box-shadow: 0 0 12px rgba(255, 81, 47, 0.7);
      opacity: 0.96;
    }

    .playhead {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 2px;
      background: #fff;
      box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
      transform: translateX(0);
    }

    .daw-transport {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
    }

    .daw-transport button {
      border-radius: 999px;
      border: none;
      padding: 6px 12px;
      font-size: 0.85rem;
      cursor: pointer;
      background: #ff512f;
      color: #fff;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.7);
    }

    .daw-transport button:hover {
      filter: brightness(1.05);
    }

    .daw-status {
      font-size: 0.8rem;
      opacity: 0.85;
      margin-top: 4px;
    }

    /* VIEW SWITCHING */

    .view {
      margin-top: 10px;
    }

    .view.hidden {
      display: none;
    }

    /* SCROLLBAR */

    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #111;
    }

    ::-webkit-scrollbar-thumb {
      background: #444;
      border-radius: 999px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #666;
    }

    @media (max-width: 900px) {
      .panel-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="logo">TAB MASTER PRO</div>

    <div class="nav-title">Studio</div>
    <div class="nav-item active" data-view="home">
      <span class="icon">üè†</span>
      <span>Home</span>
    </div>
    <div class="nav-item" data-view="songgen">
      <span class="icon">üéº</span>
      <span>Song Generator</span>
    </div>
    <div class="nav-item" data-view="stems">
      <span class="icon">üéõÔ∏è</span>
      <span>Stem Separator</span>
    </div>
    <div class="nav-item" data-view="tabs">
      <span class="icon">üé∏</span>
      <span>Tabs Studio</span>
    </div>
    <div class="nav-item" data-view="daw">
      <span class="icon">üéöÔ∏è</span>
      <span>DAW Studio</span>
    </div>

    <div class="nav-separator"></div>

    <div class="nav-item" onclick="window.location.href='ai-tools.html'">
      <span class="icon">üß™</span>
      <span>Legacy AI Tools</span>
    </div>

    <div class="sidebar-bottom">
      Built for creating riffs, stems, and full songs in one warm, inviting studio.
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <div class="main-inner">
      <!-- HOME VIEW -->
      <section id="view-home" class="view">
        <div class="hero">
          <div class="hero-left">
            <h1>Welcome to your AI‚Äëpowered music studio.</h1>
            <p>
              Generate songs, split stems, write interactive tabs, and experiment in a DAW‚Äëstyle
              mixer ‚Äî all in one place.
            </p>
            <div class="hero-tags">
              <span class="tag">Warm & vibrant workspace</span>
              <span class="tag">Song ideas in seconds</span>
              <span class="tag">Band‚Äëready stems</span>
              <span class="tag">Guitar + drums friendly</span>
            </div>
          </div>
          <div class="hero-cta">
            <button class="primary" onclick="switchView('songgen')">
              üéº Start with a Song Idea
            </button>
            <button class="secondary" onclick="switchView('stems')">
              üéß Upload a Track to Split
            </button>
          </div>
        </div>

        <div class="panel-grid">
          <div class="panel">
            <div class="panel-header">
              <h2>Song Generator</h2>
              <span class="pill">AI Studio</span>
            </div>
            <div class="panel-body">
              Describe a vibe, mood, or story and let the studio sketch out a song concept.
              <div class="field-label">Prompt</div>
              <textarea id="homeSongPrompt" placeholder="Sad mid‚Äëtempo rock track about missing someone in the rain..."></textarea>
              <button class="btn" onclick="generateSong('home')">
                Generate Song Concept
              </button>
              <div id="homeSongProgress" class="progress-bar">
                <div class="progress-fill"></div>
              </div>
              <div class="tiny">This generates lyrics + structure ‚Äî audio to come later.</div>
              <div id="homeSongOutput" class="song-output" style="display:none;"></div>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Quick Actions</h2>
              <span class="pill">Shortcuts</span>
            </div>
            <div class="panel-body">
              <div class="field-label">Jump into a tool</div>
              <div class="tabs-toolbar">
                <button class="btn btn-secondary" onclick="switchView('songgen')">üéº Song Generator</button>
                <button class="btn btn-secondary" onclick="switchView('stems')">üéß Separate Stems</button>
                <button class="btn btn-secondary" onclick="switchView('tabs')">üé∏ Tabs Studio</button>
                <button class="btn btn-secondary" onclick="switchView('daw')">üéöÔ∏è DAW Studio</button>
              </div>
              <div class="field-label" style="margin-top:10px;">Recently imagined</div>
              <p class="tiny">
                ‚Ä¢ ‚ÄúUp‚Äëtempo pop‚Äëpunk anthem about starting over.‚Äù<br />
                ‚Ä¢ ‚ÄúLo‚Äëfi chillhop loop for late‚Äënight coding.‚Äù<br />
                ‚Ä¢ ‚ÄúMelodic metal track with epic chorus.‚Äù
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- SONG GENERATOR VIEW -->
      <section id="view-songgen" class="view hidden">
        <div class="panel">
          <div class="panel-header">
            <h2>AI Song Generator</h2>
            <span class="pill">Suno‚Äëstyle Concept</span>
          </div>
          <div class="panel-body">
            <p>
              Give the studio a prompt and we‚Äôll sketch out a song concept: structure, lyrics, and vibe.
              Audio generation can plug in later.
            </p>
            <div class="field-label">Describe your track</div>
            <textarea id="songPrompt" placeholder="Energetic pop‚Äërock song with big chorus, about finally letting go of the past..."></textarea>

            <div class="field-label">Style</div>
            <select id="songStyle">
              <option>Modern Pop</option>
              <option>Pop Punk</option>
              <option>Metal / Metalcore</option>
              <option>Lo‚ÄëFi / Chill</option>
              <option>Indie Rock</option>
              <option>Acoustic / Singer‚ÄëSongwriter</option>
            </select>

            <div class="field-label">Tempo & mood</div>
            <div class="row">
              <input type="text" id="songBpm" placeholder="BPM (e.g. 120)" style="max-width:120px;" />
              <input type="text" id="songMood" placeholder="Mood (hopeful, dark, nostalgic...)" />
            </div>

            <button class="btn" onclick="generateSong('full')">‚ú® Generate Song Plan</button>
            <div id="songProgress" class="progress-bar">
              <div class="progress-fill"></div>
            </div>
            <div class="tiny">
              This is a creative assistant, not a finished track yet. Perfect for getting unstuck or starting a new idea.
            </div>

            <div id="songOutput" class="song-output" style="display:none;"></div>
          </div>
        </div>
      </section>

      <!-- STEM SEPARATOR VIEW -->
      <section id="view-stems" class="view hidden">
        <div class="panel">
          <div class="panel-header">
            <h2>AI Stem Separator</h2>
            <span class="pill">Track Processing</span>
          </div>
          <div class="panel-body">
            <p>
              Drop in a YouTube link or upload a file to separate vocals, drums, bass, and more.
              The bar shows the AI working in real time.
            </p>

            <div class="field-label">YouTube link (optional)</div>
            <input type="url" id="ytUrl" placeholder="https://www.youtube.com/watch?v=..." />

            <div class="field-label">Or upload audio</div>
            <div class="row">
              <button class="btn btn-secondary" onclick="document.getElementById('stemFile').click()">
                üìÅ Choose File
              </button>
              <input id="stemFile" class="file-input-hidden" type="file" accept=".mp3,.wav" />
              <div id="stemFileChip" class="file-chip" style="display:none;"></div>
            </div>

            <button class="btn" onclick="startStemSeparation()">üéõÔ∏è Separate Stems</button>

            <div id="stemProgress" class="progress-bar">
              <div class="progress-fill"></div>
            </div>
            <div id="stemStatus" class="tiny"></div>

            <div id="stemResults" class="song-output" style="display:none;"></div>
          </div>
        </div>
      </section>

      <!-- TABS STUDIO VIEW -->
      <section id="view-tabs" class="view hidden">
        <div class="panel">
          <div class="panel-header">
            <h2>Tabs Studio</h2>
            <span class="pill">Interactive Tabs</span>
          </div>
          <div class="panel-body">
            <p>
              Sketch guitar and drum ideas in a quick, Songsterr‚Äëstyle tab space. This is a visual scratchpad for riffs and grooves.
            </p>

            <div class="tabs-grid">
              <div>
                <div class="field-label">Guitar tab</div>
                <div id="guitarTab" class="tabs-box">
E|----------------|
B|----------------|
G|----------------|
D|----------------|
A|----------------|
E|----------------|
                </div>
              </div>

              <div>
                <div class="field-label">Drum grid</div>
                <div id="drumTab" class="tabs-box">
HH|x-x-x-x-x-x-x-x-|
SD|----o-------o---|
BD|o-------o-------|
                </div>
              </div>
            </div>

            <div class="tabs-toolbar">
              <button class="btn btn-secondary" onclick="addGuitarNote()">+ Add guitar note</button>
              <button class="btn btn-secondary" onclick="addDrumHit()">+ Add drum hit</button>
              <button class="btn btn-secondary" onclick="resetTabs()">Reset tabs</button>
            </div>

            <div class="tiny">
              Later, this can export to MIDI or talk to real playback ‚Äî for now it‚Äôs a structured idea pad.
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>

  <!-- SOUND EFFECTS -->
  <audio id="clickSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>

  <script>
    // VIEW SWITCHING
    function switchView(viewId) {
      document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
      document.getElementById('view-' + viewId).classList.remove('hidden');

      document.querySelectorAll('.nav-item[data-view]').forEach(item => {
        item.classList.toggle('active', item.getAttribute('data-view') === viewId);
      });
    }

    document.querySelectorAll('.nav-item[data-view]').forEach(item => {
      item.addEventListener('click', () => {
        const view = item.getAttribute('data-view');
        switchView(view);
      });
    });

    const clickSound = document.getElementById('clickSound');

    // SONG GENERATOR (HOME + FULL)
    function generateSong(scope) {
      const progressBar = scope === 'home'
        ? document.getElementById('homeSongProgress')
        : document.getElementById('songProgress');
      const progressFill = progressBar.querySelector('.progress-fill');
      const outputEl = scope === 'home'
        ? document.getElementById('homeSongOutput')
        : document.getElementById('songOutput');
      const promptEl = scope === 'home'
        ? document.getElementById('homeSongPrompt')
        : document.getElementById('songPrompt');

      let style = '';
      let bpm = '';
      let mood = '';

      if (scope === 'full') {
        style = document.getElementById('songStyle').value;
        bpm = document.getElementById('songBpm').value || '120';
        mood = document.getElementById('songMood').value || 'emotional';
      }

      const prompt = promptEl.value.trim() || 'A new song idea with emotional lyrics and big dynamic shifts.';

      clickSound.play();

      progressBar.style.display = 'block';
      progressFill.style.width = '0%';
      outputEl.style.display = 'none';
      outputEl.innerHTML = '';

      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.random() * 12;
        if (progress >= 100) {
          progress = 100;
          clearInterval(interval);
          const title = '‚Äú' + (prompt.slice(0, 32) || 'Untitled Idea') + '‚Äù';
          let text =
            `<strong>${title}</strong><br/><br/>` +
            `‚Ä¢ Style: ${style || 'Auto / mixed influences'}<br/>` +
            `‚Ä¢ Tempo: ${bpm} BPM<br/>` +
            `‚Ä¢ Mood: ${mood}<br/><br/>` +
            `Verse 1:<br/>` +
            `I‚Äôve been running from the echoes in my head<br/>` +
            `Every streetlight paints your name in red<br/>` +
            `All the things we never said still shaking up my chest<br/><br/>` +
            `Chorus:<br/>` +
            `So light me up, like a match in the thunder<br/>` +
            `Tear this quiet night apart, pull me from the undertow<br/>` +
            `If this is how it ends, let it sound like something bold<br/>` +
            `‚ÄôCause I‚Äôm tired of fading out in the dark alone.`;

          outputEl.innerHTML = text;
          outputEl.style.display = 'block';
        }
        progressFill.style.width = progress + '%';
      }, 180);
    }

    // STEM SEPARATOR
    const stemFileInput = document.getElementById('stemFile');
    const stemFileChip = document.getElementById('stemFileChip');

    stemFileInput.addEventListener('change', () => {
      const file = stemFileInput.files[0];
      if (file) {
        stemFileChip.textContent = file.name;
        stemFileChip.style.display = 'inline-flex';
      } else {
        stemFileChip.style.display = 'none';
      }
    });

    function startStemSeparation() {
      const ytUrl = document.getElementById('ytUrl').value.trim();
      const file = stemFileInput.files[0];

      if (!ytUrl && !file) {
        alert('Please paste a YouTube link or upload an audio file.');
        return;
      }

      clickSound.play();

      const progressBar = document.getElementById('stemProgress');
      const fill = progressBar.querySelector('.progress-fill');
      const status = document.getElementById('stemStatus');
      const results = document.getElementById('stemResults');

      progressBar.style.display = 'block';
      fill.style.width = '0%';
      status.textContent = 'Starting AI separation...';
      results.style.display = 'none';
      results.innerHTML = '';

      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.random() * 7;
        if (progress >= 100) {
          progress = 100;
          clearInterval(interval);
          status.textContent = 'Separation complete. Stems ready (placeholder).';
          results.style.display = 'block';
          results.innerHTML =
            `<strong>Stems:</strong><br/>` +
            `‚Ä¢ Vocals<br/>` +
            `‚Ä¢ Drums<br/>` +
            `‚Ä¢ Bass<br/>` +
            `‚Ä¢ Other<br/><br/>` +
            `In the future, each stem will be downloadable and routable into the DAW.`;
        }
        fill.style.width = progress + '%';
      }, 250);
    }

    // TABS STUDIO (simple playful ops)
    function addGuitarNote() {
      clickSound.play();
      const el = document.getElementById('guitarTab');
      el.textContent += '\nE|----5-----5-----5-----5--|';
    }

    function addDrumHit() {
      clickSound.play();
      const el = document.getElementById('drumTab');
      el.textContent += '\nHH|x-x-x-x-x-x-x-x-| SD|----o-------o---| BD|o-------o-------|';
    }

    function resetTabs() {
      clickSound.play();
      document.getElementById('guitarTab').textContent =
`E|----------------|
B|----------------|
G|----------------|
D|----------------|
A|----------------|
E|----------------|`;
      document.getElementById('drumTab').textContent =
`HH|x-x-x-x-x-x-x-x-|
SD|----o-------o---|
BD|o-------o-------|`;
    }

    // DAW STUDIO
    const dawFileInput = document.getElementById('dawFile');
    const dawFileChip = document.getElementById('dawFileChip');
    const dawStatus = document.getElementById('dawStatus');
    const playhead = document.getElementById('playhead');
    let dawAudio = null;
    let playheadInterval = null;

    dawFileInput.addEventListener('change', () => {
      const file = dawFileInput.files[0];
      if (file) {
        dawFileChip.textContent = file.name;
        dawFileChip.style.display = 'inline-flex';
        loadDawAudio(file);
      } else {
        dawFileChip.style.display = 'none';
      }
    });

    function loadDawAudio(file) {
      if (dawAudio) {
        dawAudio.pause();
      }
      dawAudio = new Audio(URL.createObjectURL(file));
      dawAudio.onloadedmetadata = () => {
        dawStatus.textContent = `Loaded into DAW: ${file.name} (${dawAudio.duration.toFixed(1)}s)`;
        // Show clips
        ['clip-vocals', 'clip-drums', 'clip-bass', 'clip-other'].forEach(id => {
          document.getElementById(id).style.display = 'block';
        });
      };
    }

    document.getElementById('dawPlayBtn').addEventListener('click', () => {
      clickSound.play();
      if (!dawAudio) {
        dawStatus.textContent = 'No audio loaded yet.';
        return;
      }
      dawAudio.play();
      dawStatus.textContent = 'Playing...';

      if (playheadInterval) clearInterval(playheadInterval);
      const laneWidth = document.querySelector('.daw-track-lane').clientWidth;
      const duration = dawAudio.duration || 30;
      playhead.style.left = '0px';

      const start = performance.now();
      playheadInterval = setInterval(() => {
        const elapsed = (performance.now() - start) / 1000;
        const ratio = Math.min(elapsed / duration, 1);
        playhead.style.transform = `translateX(${ratio * laneWidth}px)`;
        if (ratio >= 1) {
          clearInterval(playheadInterval);
        }
      }, 50);
    });

    document.getElementById('dawStopBtn').addEventListener('click', () => {
      clickSound.play();
      if (dawAudio) {
        dawAudio.pause();
        dawAudio.currentTime = 0;
      }
      dawStatus.textContent = 'Stopped.';
      if (playheadInterval) clearInterval(playheadInterval);
      playhead.style.transform = 'translateX(0)';
    });
  </script>
</body>
</html>
